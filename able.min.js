const upd={},app={togglables:{},zIndex:1,backStack:[],back(){app.backStack.length&&app.backStack.pop()()}};function toggle(...e){e.every(e=>e in app.togglables)||(app.togglables=[...document.getElementsByClassName("togglable")].reduce((e,t)=>({...e,[t.dataset.tgl]:t}),{})),e.forEach(e=>{const t=app.togglables[e],a=t.classList;a.contains("modal")&&!a.contains("active")&&(app.backStack.push(()=>a.contains("active")?a.remove("active"):app.back()),t.style.zIndex=app.zIndex++),a.toggle("active")})}addEventListener("load",()=>{document.querySelectorAll(".switchable").forEach(e=>{var t;(e.switch=((a,c=1)=>{const r=e.dataset.active;a==r&&1==c||(e.querySelectorAll(".mode").forEach(t=>{const c=e.id.toLowerCase();if(t.dataset[c]){if(t.dataset[c]!=a)return t.classList.remove("active");t.classList.add("active"),t.render&&t.render()}}),c&&(c>1?(clearTimeout(t),t=setTimeout(()=>e.switch("",0),1e3*c)):app.backStack.push(()=>{e.switch(r,0),"function"==typeof c&&c()})),e.dataset.active=a,event&&event.preventDefault())}))(e.dataset.active,0)}),document.querySelectorAll(".renderable").forEach(e=>{const t=e.innerHTML,a=[],c=e.dataset.src,r=app[c],n=[...new Set(t.match(/\{.+?\}/g))].reduce((e,t)=>({...e,[t]:t.split(/[.{}[\]]/g).filter(e=>e)}),{});(e.render=(c=>{if(c)return a.push(c);const o=(Array.isArray(r)?r.map((e,t)=>({...e,i:e.i||t+1})):Object.entries(r).map(([e,t],a)=>({key:e,val:t,i:a+1}))).map(e=>Object.entries(n).reduce((t,[a,c])=>({...t,[a]:c.reduce((e,t)=>e[t],e)}),{}));e.innerHTML=o.reduce((e,a)=>e+Object.entries(a).reduce((e,[t,a])=>e.split(t).join(a),t),""),a.forEach(e=>e())}))();var o=0;const s=upd[c]?Object.getOwnPropertyDescriptor(upd,c).get:()=>{};Object.defineProperty(upd,c,{configurable:!0,get:()=>(clearTimeout(o),o=setTimeout(()=>(e.render(),s()),0),r)})})}),document.head.appendChild(document.createElement("style")).innerText=".mode:not(.active), .togglable:not(.active) { display: none !important }";